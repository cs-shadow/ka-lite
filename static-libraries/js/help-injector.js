/**
 * The script will request descriptions JUST for the current URL and it should
 * get the response in following format:
 *
 * [
 *     {
 *         "ul.nav li a.admin-only": [
 *             {
 *                 "data-step": 1
 *             },
 *             {
 *                 "data-intro": "Welcome! This is the landing page for admins. If at any point you would like to navigate back to this page, click on this tab!"
 *             }
 *         ]
 *     },
 *     {
 *         "li.facility": [
 *             {
 *                 "data-step": 2
 *             },
 *             {
 *                 "data-intro": "Clicking on this tab will show you a quick overview of all facilities and devices"
 *             }
 *         ]
 *     },
 *     {
 *         "a.create-facility": [
 *             {
 *                 "data-step": 3
 *             },
 *             {
 *                 "data-intro": "To add new facilities, click here..."
 *             }
 *         ]
 *     },
 *     {
 *         "div.container div.row": [
 *             {
 *                 "data-step": 4
 *             },
 *             {
 *                 "data-intro": "Information on your device status will be shown here"
 *             }
 *         ]
 *     },
 *     {
 *         "a.create-facility": [
 *             {
 *                 "data-step": 5
 *             },
 *             {
 *                 "data-intro": "If you decide to register your device to our central club, click here"
 *             }
 *         ]
 *     },
 *     {
 *         "a.create-facility": [
 *             {
 *                 "data-step": 6
 *             },
 *             {
 *                 "data-intro": "Questions about anything on the page? Be sure to consult the user manual or FAQ for more detailed walk throughs!"
 *             }
 *         ]
 *     }
 * ]
 *
 * This format is generated by converting
 * the YAML specs @ https://s3.amazonaws.com/uploads.hipchat.com/86198/1569366/tqTYrNE3DmPqvcV/admin-general.yaml
 * into JSON, but just for one URL.
 */

$(document).ready(function(){
  // TODO: Implement the following two functions.
  description_json = download_file();
  descriptions = decode(description_json);

  // Assume we've descriptions for this particular URL is an array.
  for (var i = 0; i < descriptions.length; i++) {
    // Now we've key-value pairs of selectors where each element is keyed by
    // a selector and its value is a list of key-value pairs. Here, key is an
    // atribute and value is the value of that attribute.
    var description = descriptions[i];
    for (var selector in description) {
      var attributes = description[selector];
      for (var j = 0; j < attributes.length; j++) {
        var attribute = attributes[j];
          for (var key in attribute) {
            var value = attribute[key];
            // Inject this key-value pair of attributes into the page.
            $(selector).attr(key, value);
          }
      }
    }
  }
});
